
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HSK Flashcards v31</title>
<style>
body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
button { margin: 5px; padding: 10px 20px; font-size: 16px; }
.flashcard { border: 1px solid #ccc; border-radius: 12px; padding: 40px; margin: 20px auto;
             max-width: 400px; min-height: 200px; display: flex; flex-direction: column;
             justify-content: center; align-items: center; font-size: 24px; cursor: pointer; }
.chinese { font-size: 64px; margin: 10px 0; }
.pinyin { font-size: 36px; margin: 10px 0; }
.english { font-size: 18px; margin: 10px 0; }
.hidden { display: none; }
#progress { margin-top: 10px; font-size: 16px; }
</style>
</head>
<body>
<h1>HSK 1â€“2 Flashcards</h1>
<div>
  <button onclick="loadDeck('hsk1')">Load HSK 1</button>
  <button onclick="loadDeck('hsk2')">Load HSK 2</button>
  <button onclick="loadDeck('both')">Load HSK 1+2</button>
</div>
<div>
  <button onclick="setStartSide('mandarin')">Mandarin Start</button>
  <button onclick="setStartSide('english')">English Start</button>
</div>
<div class="flashcard hidden" id="flashcard" onclick="flipCard()">
  <div id="cardContent"></div>
</div>
<button id="nextBtn" class="hidden" onclick="nextCard()">Next</button>
<div id="progress"></div>
<script>
let deck = [];
let current = 0;
let flipped = false;
let startSide = 'mandarin';

async function loadJSON(path) {
  const resp = await fetch(path);
  return await resp.json();
}

async function loadDeck(which) {
  if (which === 'hsk1') {
    deck = await fetch('decks/hsk1.json').then(r => r.json());
  } else if (which === 'hsk2') {
    deck = await fetch('decks/hsk2.json').then(r => r.json());
  } else {
    let hsk1 = await fetch('decks/hsk1.json').then(r => r.json());
    let hsk2 = await fetch('decks/hsk2.json').then(r => r.json());
    deck = [...hsk1, ...hsk2];
  }
  shuffle(deck);
  current = 0;
  flipped = false;
  showCard();
}



function setStartSide(side) {
  startSide = side;
  flipped = false;
  
  // Reset to first card only if deck is loaded
  if (deck.length > 0) {
    current = 0; // optional: restart from first card
    showCard();
    document.getElementById('flashcard').classList.remove('hidden');
    document.getElementById('nextBtn').classList.remove('hidden');
  } else {
    alert("Please load a deck first!");
  }
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function showCard() {
  if (current >= deck.length) {
    document.getElementById('cardContent').innerHTML = 'Deck finished!';
    document.getElementById('progress').innerText = '';
    return;
  }
  let card = deck[current];
  let html = '';
  if (!flipped) {
    if (startSide === 'mandarin') html = `<div class="chinese">${card.chinese}</div><div class="pinyin">${card.pinyin}</div>`;
    else html = `<div class="english" style="font-size:20px">${card.english}</div>`;
  } else {
    if (startSide === 'mandarin') html = `<div class="english">${card.english}</div><div class="chinese" style="font-size:32px">${card.chinese}</div>`;
    else html = `<div class="chinese" style="font-size:96px">${card.chinese}</div><div class="pinyin" style="font-size:36px">${card.pinyin}</div><div class="english" style="font-size:14px">${card.english}</div>`;
  }
  document.getElementById('cardContent').innerHTML = html;
  document.getElementById('progress').innerText = `Card ${current+1} / ${deck.length}`;
}

function flipCard() { flipped = !flipped; showCard(); }
function nextCard() { current++; flipped = false; showCard(); }
</script>
</body>
</html>
